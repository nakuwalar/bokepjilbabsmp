---
// src/pages/video/[id].astro
import Layout from '../../layouts/Layout.astro';
import videosData from '../../data/videos.json';

export async function getStaticPaths() {
  return videosData.map(video => ({
    params: { id: video.id }
  }));
}

const { id } = Astro.params;
const video = videosData.find(v => v.id === id);

if (!video) {
  return Astro.redirect('/404'); // Redirect ke halaman 404 jika video tidak ditemukan
}
---

<Layout
  title={video.title}
  description={video.description}
  image={video.thumbnail}
>
  <article class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 lg:p-8">
    <h1 class="text-4xl font-bold mb-4">{video.title}</h1>
    <div class="text-gray-600 dark:text-gray-400 text-lg mb-6">
      Kategori: <a href={`/category/${encodeURIComponent(video.category.toLowerCase().replace(/\s+/g, '-'))}/`} class="text-blue-600 dark:text-blue-400 hover:underline">{video.category}</a>
    </div>

    <div class="relative w-full overflow-hidden" style="padding-top: 56.25%">
      <iframe
        class="absolute top-0 left-0 w-full h-full"
        src={video.embedUrl}
        frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen
        title={video.title}
      ></iframe>
    </div>

    <div class="prose dark:prose-invert mt-8">
      <p>{video.description}</p>
      </div>

    <script type="application/ld+json" set:html={`
      {
        "@context": "https://schema.org",
        "@type": "VideoObject",
        "name": "${video.title}",
        "description": "${video.description}",
        "thumbnailUrl": "${new URL(video.thumbnail, Astro.site).href}",
        "uploadDate": "${new Date().toISOString().split('T')[0]}", // Gunakan tanggal upload sebenarnya jika ada
        "embedUrl": "${video.embedUrl}",
        "publisher": {
          "@type": "Organization",
          "name": "Astro Video",
          "logo": {
            "@type": "ImageObject",
            "url": "${new URL('/favicon.svg', Astro.site).href}", // Ganti dengan logo Anda
            "width": 60,
            "height": 60
          }
        },
        "contentUrl": "${video.embedUrl}"
        // Tambahkan properti lain jika tersedia: duration, interactionStatistic, regionsAllowed
      }
    `} />
  </article>
</Layout>